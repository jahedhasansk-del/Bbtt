<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advanced Prediction App</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Courier New', monospace;
      background: #0a0e27;
      color: #00ff88;
      padding: 20px;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
      padding: 20px;
      background: rgba(0, 255, 136, 0.1);
      border: 2px solid #00ff88;
      border-radius: 10px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }

    .stat-box {
      background: rgba(0, 20, 40, 0.8);
      border: 2px solid #00ff88;
      border-radius: 10px;
      padding: 20px;
      text-align: center;
    }

    .stat-label {
      font-size: 14px;
      color: #00ff88;
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 10px;
    }

    .stat-value {
      font-size: 36px;
      font-weight: bold;
      color: #fff;
    }

    .prediction-box {
      background: rgba(0, 20, 40, 0.8);
      border: 2px solid #00ff88;
      border-radius: 10px;
      padding: 25px;
      margin-bottom: 30px;
    }

    .prediction-title {
      font-size: 18px;
      color: #00ff88;
      margin-bottom: 20px;
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 3px;
    }

    .prediction-content {
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
      gap: 20px;
    }

    .prediction-item {
      text-align: center;
    }

    .prediction-item h4 {
      color: #00ff88;
      margin-bottom: 10px;
      font-size: 14px;
    }

    .numbers-display {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-top: 10px;
    }

    .number-circle {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: 3px solid #00ff88;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      font-weight: bold;
      color: #fff;
      background: rgba(0, 255, 136, 0.2);
      box-shadow: 0 0 15px rgba(0, 255, 136, 0.5);
    }

    .confidence-meter {
      margin-top: 20px;
      text-align: center;
    }

    .confidence-bar {
      width: 100%;
      height: 30px;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 15px;
      overflow: hidden;
      margin-top: 10px;
      border: 2px solid #00ff88;
    }

    .confidence-fill {
      height: 100%;
      background: linear-gradient(90deg, #ff4757, #ffa502, #00ff88);
      transition: width 0.5s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: #000;
    }

    .table-container {
      background: rgba(0, 20, 40, 0.8);
      border: 2px solid #00ff88;
      border-radius: 10px;
      padding: 20px;
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th {
      background: rgba(0, 255, 136, 0.2);
      padding: 12px;
      text-align: center;
      color: #00ff88;
      text-transform: uppercase;
      font-size: 12px;
      letter-spacing: 1px;
      border: 1px solid #00ff88;
    }

    td {
      padding: 12px;
      text-align: center;
      border: 1px solid rgba(0, 255, 136, 0.3);
      color: #fff;
    }

    tr:hover {
      background: rgba(0, 255, 136, 0.1);
    }

    .color-dots {
      display: flex;
      gap: 5px;
      justify-content: center;
    }

    .color-dot {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid rgba(255, 255, 255, 0.5);
    }

    .color-dot.violet {
      background: #9b59b6;
      box-shadow: 0 0 10px #9b59b6;
    }

    .color-dot.green {
      background: #00ff88;
      box-shadow: 0 0 10px #00ff88;
    }

    .color-dot.red {
      background: #ff4757;
      box-shadow: 0 0 10px #ff4757;
    }

    .result-win {
      color: #00ff88;
      font-weight: bold;
      text-shadow: 0 0 5px #00ff88;
    }

    .result-loss {
      color: #ff4757;
      font-weight: bold;
      text-shadow: 0 0 5px #ff4757;
    }

    .refresh-btn {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: #00ff88;
      border: none;
      color: #0a0e27;
      font-size: 16px;
      font-weight: bold;
      padding: 15px 30px;
      border-radius: 50px;
      cursor: pointer;
      box-shadow: 0 5px 20px rgba(0, 255, 136, 0.5);
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .refresh-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 30px rgba(0, 255, 136, 0.8);
    }

    .loading {
      text-align: center;
      padding: 30px;
      color: #00ff88;
      font-size: 18px;
    }

    .timer {
      position: fixed;
      bottom: 30px;
      left: 30px;
      font-size: 48px;
      color: #00ff88;
      text-shadow: 0 0 20px rgba(0, 255, 136, 0.8);
      font-weight: bold;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .pulse {
      animation: pulse 2s infinite;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ðŸŽ¯ ADVANCED PREDICTION SYSTEM</h1>
      <p>Multi-Algorithm Intelligence</p>
    </div>

    <div class="stats-grid">
      <div class="stat-box">
        <div class="stat-label">Win</div>
        <div class="stat-value" id="wc">0</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">Loss</div>
        <div class="stat-value" id="lc">0</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">Total</div>
        <div class="stat-value" id="tc">0</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">Accuracy</div>
        <div class="stat-value" id="wr">0%</div>
      </div>
    </div>

    <div class="prediction-box">
      <div class="prediction-title">ðŸ”® Next Prediction</div>
      <div class="prediction-content">
        <div class="prediction-item">
          <h4>PREDICTED NUMBERS</h4>
          <div class="numbers-display" id="predicted-numbers">
            <div class="number-circle">?</div>
          </div>
        </div>
        <div class="prediction-item">
          <h4>SIZE</h4>
          <div style="font-size: 24px; margin-top: 10px; color: #fff;" id="predicted-size">-</div>
        </div>
        <div class="prediction-item">
          <h4>COLORS</h4>
          <div class="color-dots" id="predicted-colors" style="margin-top: 10px;">
            <div class="color-dot violet"></div>
          </div>
        </div>
      </div>
      <div class="confidence-meter">
        <h4>CONFIDENCE LEVEL</h4>
        <div class="confidence-bar">
          <div class="confidence-fill" id="confidence-fill" style="width: 0%">0%</div>
        </div>
      </div>
    </div>

    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>PERIOD</th>
            <th>NUMBER</th>
            <th>SIZE</th>
            <th>COLOR</th>
            <th>RESULT</th>
          </tr>
        </thead>
        <tbody id="tb">
          <tr>
            <td colspan="5" class="loading">Loading...</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="timer" id="timer">00:00:00</div>
  <button class="refresh-btn" onclick="location.reload()">ðŸ”„ REFRESH</button>

<script>
(function() {
  'use strict';

  const _0x4a = ['per', 'number', 'win', 'loss'];
  const _api = 'https://api.bdg88zf.com/api/webapi/GetNoaverageEmerdList';
  let _h = [];

  // ===== ADVANCED PREDICTION LOGIC =====

  function analyzeFrequency(history, limit = 20) {
    const recent = history.slice(-limit);
    const freq = {};
    
    recent.forEach(item => {
      const num = parseInt(item.number);
      freq[num] = (freq[num] || 0) + 1;
    });
    
    return freq;
  }

  function analyzeGaps(history) {
    const gaps = {};
    
    for (let num = 0; num <= 9; num++) {
      gaps[num] = 0;
    }
    
    for (let i = history.length - 1; i >= 0; i--) {
      const num = parseInt(history[i].number);
      
      for (let n = 0; n <= 9; n++) {
        if (n === num) {
          gaps[n] = 0;
        } else {
          gaps[n]++;
        }
      }
    }
    
    return gaps;
  }

  function analyzeStreak(history, limit = 10) {
    const recent = history.slice(-limit);
    let bigCount = 0;
    let smallCount = 0;
    let redCount = 0;
    let greenCount = 0;
    let violetCount = 0;
    
    recent.forEach(item => {
      const num = parseInt(item.number);
      
      if (num >= 5) bigCount++;
      else smallCount++;
      
      if ([1, 3, 7, 9].includes(num)) greenCount++;
      if ([2, 4, 6, 8].includes(num)) redCount++;
      if ([0, 5].includes(num)) violetCount++;
    });
    
    return { bigCount, smallCount, redCount, greenCount, violetCount };
  }

  function findHotColdNumbers(frequency, gaps) {
    const hotNumbers = [];
    const coldNumbers = [];
    
    for (let num = 0; num <= 9; num++) {
      const freq = frequency[num] || 0;
      const gap = gaps[num] || 0;
      
      if (freq >= 3 && gap <= 5) {
        hotNumbers.push(num);
      }
      
      if (freq <= 1 && gap >= 8) {
        coldNumbers.push(num);
      }
    }
    
    return { hotNumbers, coldNumbers };
  }

  function calculateWeightedScores(history) {
    const scores = {};
    
    const frequency = analyzeFrequency(history, 20);
    const gaps = analyzeGaps(history);
    const streak = analyzeStreak(history, 10);
    const { hotNumbers, coldNumbers } = findHotColdNumbers(frequency, gaps);
    
    for (let num = 0; num <= 9; num++) {
      let score = 50;
      
      const freq = frequency[num] || 0;
      if (freq >= 4) score -= 15;
      else if (freq <= 1) score += 15;
      
      const gap = gaps[num] || 0;
      if (gap >= 10) score += 20;
      else if (gap <= 2) score -= 10;
      
      if (coldNumbers.includes(num)) score += 15;
      if (hotNumbers.includes(num)) score += 10;
      
      if (num >= 5 && streak.bigCount >= 3) score -= 10;
      if (num < 5 && streak.smallCount >= 3) score -= 10;
      if (num >= 5 && streak.smallCount >= 3) score += 15;
      if (num < 5 && streak.bigCount >= 3) score += 15;
      
      if ([1, 3, 7, 9].includes(num) && streak.greenCount >= 4) score -= 8;
      if ([2, 4, 6, 8].includes(num) && streak.redCount >= 4) score -= 8;
      if ([1, 3, 7, 9].includes(num) && streak.redCount >= 3) score += 10;
      if ([2, 4, 6, 8].includes(num) && streak.greenCount >= 3) score += 10;
      
      scores[num] = Math.max(0, Math.min(100, score));
    }
    
    return scores;
  }

  function generateAdvancedPrediction(history) {
    if (!history || history.length < 5) {
      return {
        numbers: [0, 5],
        size: 'Small',
        colors: ['violet', 'green'],
        confidence: 50
      };
    }
    
    const scores = calculateWeightedScores(history);
    const streak = analyzeStreak(history, 10);
    
    const sortedPredictions = Object.entries(scores)
      .sort((a, b) => b[1] - a[1])
      .slice(0, 3);
    
    const predictedNumbers = sortedPredictions.map(p => parseInt(p[0]));
    const avgConfidence = Math.round(sortedPredictions.reduce((sum, p) => sum + p[1], 0) / 3);
    
    const predictedSize = predictedNumbers[0] >= 5 ? 'Big' : 'Small';
    
    const predictedColors = [];
    predictedNumbers.forEach(num => {
      if ([1, 3, 7, 9].includes(num) && !predictedColors.includes('green')) {
        predictedColors.push('green');
      }
      if ([2, 4, 6, 8].includes(num) && !predictedColors.includes('red')) {
        predictedColors.push('red');
      }
      if ([0, 5].includes(num) && !predictedColors.includes('violet')) {
        predictedColors.push('violet');
      }
    });
    
    return {
      numbers: predictedNumbers,
      size: predictedSize,
      colors: predictedColors,
      confidence: avgConfidence
    };
  }

  // ===== UTILITY FUNCTIONS =====

  const _g = (n, c) => {
    const cl = [];
    if ([1, 3, 7, 9].includes(n)) cl.push('green');
    if ([2, 4, 6, 8].includes(n)) cl.push('red');
    if ([0, 5].includes(n)) cl.push('violet');
    return cl;
  };

  const _d = (h) => {
    let r = '';
    for (let i = 0; i < h.length; i += 2) {
      r += String.fromCharCode(parseInt(h.substr(i, 2), 16));
    }
    return r;
  };

  // ===== LOAD DATA =====

  const _l = async () => {
    try {
      const response = await fetch(_api, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ typeId: 1, language: 0 })
      });

      const data = await response.json();
      
      if (data && data.data && data.data.list) {
        _h = data.data.list.slice(0, 10);
        _u();
        _up();
      }
    } catch (e) {
      console.error('Error loading data:', e);
    }
  };

  // ===== UPDATE PREDICTION =====

  const _up = () => {
    const prediction = generateAdvancedPrediction(_h);
    
    const numbersContainer = document.getElementById('predicted-numbers');
    numbersContainer.innerHTML = '';
    prediction.numbers.forEach(num => {
      const circle = document.createElement('div');
      circle.className = 'number-circle pulse';
      circle.textContent = num;
      numbersContainer.appendChild(circle);
    });
    
    document.getElementById('predicted-size').textContent = prediction.size;
    
    const colorsContainer = document.getElementById('predicted-colors');
    colorsContainer.innerHTML = '';
    prediction.colors.forEach(color => {
      const dot = document.createElement('div');
      dot.className = `color-dot ${color}`;
      colorsContainer.appendChild(dot);
    });
    
    const confidenceFill = document.getElementById('confidence-fill');
    confidenceFill.style.width = prediction.confidence + '%';
    confidenceFill.textContent = prediction.confidence + '%';
  };

  // ===== UPDATE TABLE =====

  const _u = () => {
    try {
      const tb = document.getElementById('tb');
      tb.innerHTML = '';

      let wc = 0;
      let lc = 0;

      _h.forEach(item => {
        const tr = document.createElement('tr');
        
        const pv = item[_0x4a[0]];
        const rn = item[_0x4a[1]];
        const co = item.colour || '';

        const tdp = document.createElement('td');
        tdp.textContent = pv;
        
        const tdn = document.createElement('td');
        tdn.textContent = rn;
        tdn.style.fontSize = '24px';
        tdn.style.fontWeight = 'bold';
        tdn.style.color = '#00ff88';
        
        const tds = document.createElement('td');
        tds.textContent = parseInt(rn) >= 5 ? 'Big' : 'Small';
        
        const tdc = document.createElement('td');
        tdc.className = 'color-dots';
        
        const nv = parseInt(rn);
        const cls = _g(nv, co);
        cls.forEach(c => {
          const dt = document.createElement('span');
          dt.className = `color-dot ${c}`;
          tdc.appendChild(dt);
        });
        
        const tdr = document.createElement('td');
        const mr = _h.find(q => String(q.per) === String(pv));
        if (mr) {
          if (mr.res === _0x4a[2]) {
            tdr.className = 'result-win';
            tdr.textContent = 'âœ“ WIN';
            wc++;
          } else {
            tdr.className = 'result-loss';
            tdr.textContent = 'âœ— LOSS';
            lc++;
          }
        } else {
          tdr.textContent = '-';
        }
        
        tr.appendChild(tdp);
        tr.appendChild(tdn);
        tr.appendChild(tds);
        tr.appendChild(tdc);
        tr.appendChild(tdr);
        tb.appendChild(tr);
      });

      const to = wc + lc;
      const wrt = to > 0 ? Math.round((wc / to) * 100) : 0;
      document.getElementById('wc').textContent = wc;
      document.getElementById('lc').textContent = lc;
      document.getElementById('tc').textContent = to;
      document.getElementById('wr').textContent = wrt + '%';
    } catch (e) {
      console.error('Error updating table:', e);
      document.getElementById('tb').innerHTML = '<tr><td colspan="5" class="loading">[ ERROR ]</td></tr>';
    }
  };

  // ===== TIMER =====

  const _t = () => {
    setInterval(() => {
      const now = new Date();
      const h = String(now.getHours()).padStart(2, '0');
      const m = String(now.getMinutes()).padStart(2, '0');
      const s = String(now.getSeconds()).padStart(2, '0');
      document.getElementById('timer').textContent = `${h}:${m}:${s}`;
    }, 1000);
  };

  // ===== INITIALIZE =====

  _l();
  _t();
  setInterval(_l, 60000); // Refresh every minute
})();
</script>

</body>
</html>
